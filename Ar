// Đầu file
#include "data/data_user.h"
#include "my_database.h" // Include file của bạn

// Biến toàn cục
static MyDatabase db;

void UserData::applyUpdate(const MTPDuser& update) {
 // Chuyển đổi mtpString sang QString
 QString firstName = qs(update.vfirst_name());
 QString lastName = qs(update.vlast_name());
 QString username = qs(update.vusername());
 QString phone = qs(update.vphone());

 // Gọi setName với QString
 setName(firstName, lastName);
 setUsername(username);
 setPhone(phone);

 // Lưu vào SQLite với dữ liệu đã chuyển đổi
 db.saveContact(id().v, username.toStdString(), firstName.toStdString(), lastName.toStdString(), phone.toStdString());
} 




// Đầu file
#include "history/history_message.h"
#include "my_database.h"

// Biến toàn cục
static MyDatabase db;

HistoryMessage::HistoryMessage(not_null<History*> history, const MTPDmessage& data)
 : HistoryItem(history, data.vid().v, data.vdate().v, data.vfrom_id() ? data.vfrom_id()->v : 0) {
 // Chuyển đổi nội dung tin nhắn từ mtp String sang QString
 QString content = data.vmessage() ? qs(*data.vmessage()) : QString();

 // Lưu vào SQLite
 db.saveMessage(id(), history->peer->id.value, fromId(), content.toStdString(), date());
}
​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​





​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​
