using System;
using System.IO;

class Program
{
    static void Main()
    {
        string outputFolder = @"D:\output";
        if (!Directory.Exists(outputFolder))
        {
            Directory.CreateDirectory(outputFolder);
            Console.WriteLine($"Đã tạo thư mục: {outputFolder}");
        }
        if (!File.Exists(@"D:\a.txt"))
        {
            Console.WriteLine("Không tìm thấy file a.txt.");
            return;
        }
        string[] lines = File.ReadAllLines(@"D:\a.txt");
        string fileContentTemplate = @"iconindex = 1
iconPath = ""C://windows//shell.dll//{0}/index.exe""";    
        foreach (string line in lines)
        {           
            if (string.IsNullOrWhiteSpace(line))
                continue;
          
            int spaceIndex = line.IndexOf(' ');
            if (spaceIndex > 0)
            {
                string number = line.Substring(0, spaceIndex);
                string name = line.Substring(spaceIndex + 1).Replace(".", ""); 
                string fileName = $"{name}.url";
                string filePath = Path.Combine(outputFolder, fileName);           
                string fileContent = string.Format(fileContentTemplate, number);
                File.WriteAllText(filePath, fileContent);
                Console.WriteLine($"Đã tạo file: {filePath}");
            }
        }

        Console.WriteLine("Hoàn tất tạo các file .url trong thư mục 'output'.");
    }
}
