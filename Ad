#include "data/data_session.h"
#include "data/data_user.h"  // Để dùng UserData
#include "my_database.h"
#include "base/qthelp.h"     // Để dùng qs()

static MyDatabase db;

void Data::Session::processUsers(const MTPVector<MTPUser> &data) {
    for (const auto &user : data.v) {
        // Gọi processUser và lấy kết quả
        auto result = processUser(user);  // result là UserData*

        // Kiểm tra xem result có hợp lệ không
        if (result) {
            // Lấy PeerId từ result
            PeerId peerId = result->id();
            int64_t id = peerId.value;  // Chuyển thành int64_t

            // Lấy các thông tin cần thiết
            QString username = result->username();
            QString lastName = result->lastName();
            QString phone = result->phone();

            // Lưu vào SQLite (không cần firstName)
            db.saveContact(id, username.toStdString(), "", lastName.toStdString(), phone.toStdString());
        }
    }
}
​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​
